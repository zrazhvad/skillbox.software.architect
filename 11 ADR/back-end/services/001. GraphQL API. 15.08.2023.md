# Реализация API поиска на основе GraphQL

## Контекст

Есть документориентированная база данных. Требуется сделать унифицированный доступ к поиску с авторизацией, произвольной фильтрацией, выборкой определенных полей, сортировкой. Требуется возможность ограничить доступ к определенным отдельным полям.

## Решение

Решено реализовать GraphQL api а точнее HotChocolate. Это открытая библиотека с реализацией GraphQL для платформы .net. Содержит подробную документацию и продолжает разрабатываться. Легко устанавливается через NuGet. Имеет консоль для тестирования запросов. Есть возможность расширять запросы данными из других хранилищ. Есть возможность закрыть авторизацией отдельные поля выборки. GraphQl - унифицированный язык запросов к апи, большинство FrontEnd плагинов могут работать с ним из коробки, а так же есть возможность использовать Apollo Client.

## Последствия

На текущий момент HotChocolate не поддерживает ElastcSearch-like системы. Для реализации этой совместимости пришлось сделать собственную реализацию IQueryable для построения запросов к OpenSearch из дерева выражений Linq. Система легко конфигурируется. Можно включать и отключать особенности полнотекстового поиска.

## Альтернативы

### OData

Более бедный функционал. Необходимость писать REST. Проблему с деревом выражений для OpenSearch - не решает, так же надо писать свою реализацию IQueryable. Хуже поддержка расширений для отдельных полей. Нет поддержки авторизации для отедльных полей.

## Ссылки

[HotChocolate](https://chillicream.com/docs/hotchocolate/v13)
[OData](https://habr.com/ru/companies/alfastrah/articles/568414/)